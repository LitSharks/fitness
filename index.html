<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fitness Coaching Program</title>
  <style>
    /* Basic styling */
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
    header { background: #333; color: #fff; padding: 1em; }
    header nav a { color: #fff; text-decoration: none; margin-right: 1em; font-weight: bold; cursor: pointer; }
    .tab-content { display: none; padding: 1em; }
    .tab-content.active { display: block; }
    .info-box { position: fixed; right: 0; top: 60px; background: #f9f9f9; border-left: 2px solid #ccc; padding: 1em; width: 300px; max-height: 80%; overflow-y: auto; }
    .table-container { overflow-x: auto; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 1em; }
    th, td { border: 1px solid #ccc; padding: 0.5em; text-align: center; }
    .login-form { max-width: 300px; margin: 1em auto; border: 1px solid #ccc; padding: 1em; border-radius: 5px; }
    .login-form input { width: 100%; padding: 0.5em; margin-bottom: 1em; }
    .admin-panel { padding: 1em; background: #efefef; margin-bottom: 1em; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <header>
    <nav>
      <!-- These tabs are hidden until login -->
      <a data-tab="training" class="tab-link" id="navTraining" style="display:none;">Training Plan</a>
      <a data-tab="tutorials" class="tab-link" id="navTutorials" style="display:none;">Tutorials</a>
      <!-- Login is visible initially -->
      <a data-tab="login" class="tab-link" id="navLogin">Login</a>
      <!-- Admin control is hidden until an admin logs in -->
      <a data-tab="admin" class="tab-link" id="navAdmin" style="display:none;">Admin Control</a>
      <a id="logoutLink" style="display:none; cursor:pointer; color:#fff; margin-left:1em;">Logout</a>
    </nav>
  </header>

  <!-- Training Plan Tab -->
  <div id="training" class="tab-content">
    <h2>Stamina Training Plan - 5 Weeks</h2>
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Week</th>
            <th>M</th>
            <th>TU</th>
            <th>W</th>
            <th>TH</th>
            <th>F</th>
            <th>SA</th>
            <th>SU</th>
          </tr>
        </thead>
        <tbody id="trainingTableBody">
          <!-- Sample row (can be dynamically updated via the API later) -->
          <tr>
            <td>T1</td>
            <td>Off</td>
            <td>10-15 min w-up<br>30 sec sprint (70-80%)<br>to 60 sec walk<br>(4-12 times)</td>
            <td>10-15 min c-d<br>X-train or 20-25 min EZ</td>
            <td>10-15 min w-up<br>30-40 min Tempo run<br>(80â€“85% effort)</td>
            <td>-10-15 min c-d<br>X-train or 20-25 min EZ</td>
            <td>Off</td>
            <td>45-55 min Long Run</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="info-box">
      <h3>Notes</h3>
      <p><strong>X-train</strong> (cross train) means to do something other than running but still targets the legs (e.g., biking, swimming, etc.).</p>
      <p>On Hard days train Hard and on EZ days train Easy.</p>
      <p>Eat well &amp; Sleep well (7-9 hours).</p>
      <p>Ask if you want alternative workouts (e.g., Strength-endurance: calisthenics + weights).</p>
    </div>
  </div>

  <!-- Tutorials Tab -->
  <div id="tutorials" class="tab-content">
    <h2>Tutorials</h2>
    <ul id="tutorialList">
      <li><a href="https://www.youtube.com/watch?v=k5vqiyry2z8" target="_blank">Tempo Run</a></li>
      <li><a href="https://www.youtube.com/watch?v=L_vZjikr5Ew" target="_blank">Breathing Easier</a></li>
      <li><a href="https://www.youtube.com/watch?v=Z3crT2UBeJE" target="_blank">Fartlek Run</a></li>
      <li><a href="https://www.youtube.com/watch?v=5B1LxT_6GW0" target="_blank">Long Run</a></li>
      <li><a href="https://www.youtube.com/shorts/s14SzolOHDY" target="_blank">Strides</a></li>
    </ul>
  </div>

  <!-- Login Tab -->
  <div id="login" class="tab-content active">
    <h2>User Login</h2>
    <div class="login-form" id="loginForm">
      <input type="text" id="username" placeholder="Username" />
      <input type="password" id="password" placeholder="Password" />
      <button id="loginBtn">Login</button>
    </div>
    <div id="userContent" style="display:none;">
      <h3>Welcome, <span id="loggedInUser"></span>!</h3>
      <p>This is your personalized fitness plan content.</p>
      <!-- Future: load user-specific training plan and tutorials here -->
    </div>
  </div>

  <!-- Admin Control Tab -->
  <div id="admin" class="tab-content">
    <h2>Admin Control Panel</h2>
    <div class="admin-panel">
      <button id="loadUsers">Load Users</button>
      <div id="userList"></div>
      <h3>Add New User</h3>
      <input type="text" id="newUsername" placeholder="New Username" />
      <input type="text" id="newPassword" placeholder="New Password" />
      <button id="addUser">Add User</button>
    </div>
    <!-- User Editing Page (hidden by default) -->
    <div id="editUser" style="display:none;">
      <h3>Edit User: <span id="editUsernameDisplay"></span></h3>
      <input type="text" id="editUsername" placeholder="Username" /><br>
      <input type="text" id="editPassword" placeholder="Password" /><br>
      <h4>Training Plan</h4>
      <textarea id="editTraining" rows="6" cols="50"></textarea><br>
      <h4>Tutorials</h4>
      <textarea id="editTutorials" rows="6" cols="50"></textarea><br>
      <button id="saveEdit">Save Changes</button>
      <button id="cancelEdit">Cancel</button>
    </div>
  </div>

  <!-- Include jsrsasign for Google Sheets API functionality if needed -->
  <script src="https://cdn.jsdelivr.net/npm/jsrsasign"></script>
  <script>
    // In-memory storage for demo (not persistent)
    let users = {
      "cardio": "guy",   // Admin credentials
      "user1": "password1"
    };
    let userData = {
      "user1": {
        training: "Default training plan for user1.",
        tutorials: "Default tutorials for user1."
      }
    };
    let currentUser = null;

    // Tab switching logic
    document.querySelectorAll('.tab-link').forEach(link => {
      link.addEventListener('click', () => {
        const tabId = link.getAttribute('data-tab');
        document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
      });
    });

    // Login functionality
    document.getElementById('loginBtn').addEventListener('click', () => {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      if (users[username] && users[username] === password) {
        currentUser = username;
        alert('Login successful!');
        // Hide login form and show personalized content
        document.getElementById('loginForm').style.display = 'none';
        document.getElementById('userContent').style.display = 'block';
        document.getElementById('loggedInUser').textContent = username;
        // Reveal the Training and Tutorials tabs
        document.getElementById('navTraining').style.display = 'inline';
        document.getElementById('navTutorials').style.display = 'inline';
        // Hide the Login tab and show Logout link
        document.getElementById('navLogin').style.display = 'none';
        document.getElementById('logoutLink').style.display = 'inline';
        // If admin, also show the Admin Control tab
        if(username === 'cardio'){
          document.getElementById('navAdmin').style.display = 'inline';
        }
        // Switch to Training tab after login
        document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
        document.getElementById('training').classList.add('active');
      } else {
        alert('Invalid username or password.');
      }
    });

    // Logout functionality
    document.getElementById('logoutLink').addEventListener('click', () => {
      currentUser = null;
      // Hide user-specific tabs
      document.getElementById('navTraining').style.display = 'none';
      document.getElementById('navTutorials').style.display = 'none';
      document.getElementById('navAdmin').style.display = 'none';
      // Show Login tab again
      document.getElementById('navLogin').style.display = 'inline';
      document.getElementById('logoutLink').style.display = 'none';
      // Reset login view
      document.getElementById('loginForm').style.display = 'block';
      document.getElementById('userContent').style.display = 'none';
      // Switch back to Login tab
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
      document.getElementById('login').classList.add('active');
    });

    // Admin panel functions
    document.getElementById('loadUsers').addEventListener('click', () => {
      let output = '<ul>';
      for (const user in users) {
        output += `<li>${user} - ${users[user]} 
          <button onclick="editUser('${user}')">Edit</button> 
          <button onclick="deleteUser('${user}')">Delete</button></li>`;
      }
      output += '</ul>';
      document.getElementById('userList').innerHTML = output;
    });

    document.getElementById('addUser').addEventListener('click', () => {
      const newUsername = document.getElementById('newUsername').value;
      const newPassword = document.getElementById('newPassword').value;
      if(newUsername && newPassword){
        users[newUsername] = newPassword;
        // Initialize default content for the new user
        userData[newUsername] = {
          training: "Default training plan.",
          tutorials: "Default tutorials."
        };
        alert('User added.');
        document.getElementById('newUsername').value = '';
        document.getElementById('newPassword').value = '';
        document.getElementById('loadUsers').click();
      } else {
        alert('Please enter both username and password.');
      }
    });

    function deleteUser(username) {
      if (confirm(`Are you sure you want to delete ${username}?`)) {
        delete users[username];
        delete userData[username];
        document.getElementById('loadUsers').click();
      }
    }

    function editUser(username) {
      // Show the editing section and populate fields with the user's current data
      document.getElementById('editUser').style.display = 'block';
      document.getElementById('editUsernameDisplay').textContent = username;
      document.getElementById('editUsername').value = username;
      document.getElementById('editPassword').value = users[username];
      document.getElementById('editTraining').value = userData[username] ? userData[username].training : "";
      document.getElementById('editTutorials').value = userData[username] ? userData[username].tutorials : "";
    }

    document.getElementById('saveEdit').addEventListener('click', () => {
      const oldUsername = document.getElementById('editUsernameDisplay').textContent;
      const newUsername = document.getElementById('editUsername').value;
      const newPassword = document.getElementById('editPassword').value;
      const newTraining = document.getElementById('editTraining').value;
      const newTutorials = document.getElementById('editTutorials').value;
      
      // Update credentials and content; if username changed, update keys accordingly
      if(newUsername !== oldUsername){
        users[newUsername] = newPassword;
        delete users[oldUsername];
        userData[newUsername] = { training: newTraining, tutorials: newTutorials };
        delete userData[oldUsername];
      } else {
        users[newUsername] = newPassword;
        userData[newUsername] = { training: newTraining, tutorials: newTutorials };
      }
      alert('User updated.');
      document.getElementById('editUser').style.display = 'none';
      document.getElementById('loadUsers').click();
    });

    document.getElementById('cancelEdit').addEventListener('click', () => {
      document.getElementById('editUser').style.display = 'none';
    });
  </script>
</body>
</html>
